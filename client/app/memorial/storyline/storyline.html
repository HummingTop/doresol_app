<div class="col-sm-8">
  <!-- create new story -->
  <div class="block">
      <div class="block-title">
          <!-- 공개, 비공개 여부는 나중에..일단 주석-->
          <!-- <div class="block-options pull-right">
            <span ng-if="newStory.public">
              <span class="text-muted">공개</span>
              <span class="btn btn-sm btn-alt btn-default" ng-click="newStory.public = !newStory.public" popover="Public" popover-trigger="mouseenter" popover-placement="right" >
                <i class="fa fa-unlock-alt"></i>
              </span>
            </span>
            <span ng-if="!newStory.public">
              <span class="text-muted">비공개</span>
              <span class="btn btn-sm btn-alt btn-default" ng-click="newStory.public = !newStory.public" popover="Public" popover-trigger="mouseenter" popover-placement="right" >
                <i class="fa fa-lock"></i>
              </span>
            </span>
          </div> -->
          <h2><strong><i class="fa fa-envelope-o"></i></strong> NEW</h2>
      </div>
      <form name="newStoryForm" class="block-content-full block-content-mini-padding" ng-submit="createNewStory(newStoryForm)" novalidate>
        <input type="text" class="form-control" ng-model="newStory.headline" placeholder="제목" style="margin: 1px 0px 10px;" ng-required="true"/>
        <textarea class="form-control" ng-model="newStory.text" rows="2" placeholder="전하고 싶은 이야기.." style="resize: vertical;margin: 1px 0px 10px;" ng-required="true"/>
        <div class="clearfix">
            <button type="submit" class="btn btn-sm btn-primary pull-right" ng-disabled="newStoryForm.$invalid"><i class="fa fa-pencil"></i> 등록</button>
            <div flow-init="{
                 singleFile: true,
                 target:'/api/fileuploads', 
                 testChunks: false,
                 generateUniqueIdentifier: getFlowFileUniqueId,
                 simultaneousUploads: 3
                }"

                flow-files-added="flowFilesAdded($files)"
                flow-files-submitted="$flow.upload()"
                
                ng-style="style">
             <!--  <a href="javascript:void(0)" class="btn btn-link btn-icon" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Add Photo">
                <i class="fa fa-camera"></i>
              </a> -->
              <div class="flow-thumbnail">
                <div ng-show="newStory.file.type == 'image'">
                  <img flow-img="$flow.files[0]" style="width:200px;height:200px;"/>
                  <!-- <img flow-image="story.file" class="superbox-img"> -->
                </div>
                <div ng-show="newStory.file.type == 'video'">
                  <!-- <video flow-video="story.file" class="superbox-img" ng-show="story.file.isComplete()" controls>  -->
                </div>
                <div class="flow-thumbnail-remove"><i class="fa fa-times-circle fa-2x text-danger" ng-click="removeFlowFile()"></i></div>
              </div>
              <span class="btn btn-link btn-icon" flow-attrs="{accept:['image/*','video/*']}" flow-btn="" popover="Add Photo/Video" popover-trigger="mouseenter" popover-placement="left"><i class="fa fa-camera"></i><input type="file" multiple="multiple" style="visibility: hidden; position: absolute;"></span>
            </div>
        </div>
      </form>
  </div>

  <!-- story list -->                    
	<ul class="storyline media-list">
	  <li class="storyline-story media" ng-repeat="story in storiesArray">
      

        <div class="story-avatar">
          <img ng-src="{{users[story.ref_user].profile.image}}" style="width:64px;height:64px;"/>
        </div>
        
	      <div class="media-body">
	      		<!-- author -->
	          <p>
              <span class="text-muted pull-right">
                <small>{{story.fromNow}}</small>
                <span class="text-success"><i class="fa fa-globe" popover="From Web" popover-trigger="mouseenter" popover-placement="right" ></i></span>
                <span class="text-danger" ng-if="story.ref_user == currentUser.uid" >
                  <i class="fa fa-times-circle" popover="Delete" popover-trigger="mouseenter" popover-placement="right" ng-click="removeStory(story)"></i>
                </span>
              </span>
              <strong class="story-user-id">{{users[story.ref_user].profile.name}}</strong>
	          </p>
	          
	          <!-- headline, text -->
	          <div class="story-show">
							<div ng-if="story.ref_user == currentUser.uid">
								<h3><strong><input type="text" ng-model="story.headline" ng-blur="storyContentChanged(story)" placeholder="제목을 입력하세요.." /></strong></h3>
		          	<p><textarea class="form-control" ng-model="story.text" ng-blur="storyContentChanged(story)" placeholder="설명을 입력하세요.." rows="5" style="resize: vertical;"/></p>
                <!-- <h3><strong><input type="text" ng-change="textChange()" ng-model="text" placeholder="제목을 입력하세요.." /></strong></h3>
                <p><textarea class="form-control" ng-model="story.text" placeholder="설명을 입력하세요.." rows="5" style="resize: vertical;"/></p> -->
							</div>
						</div>
						<div ng-if="story.ref_user != currentUser.uid">
							<h3><strong>{{story.headline}}</strong></h3>
	          	<p>{{story.text}}</p>
						</div>

						<!-- file display -->
	          <p>
	          	<div ng-if="story.file.type == 'image'">
          			<img ng-src="{{story.file.url}}" class="storyline-img"> 
        			</div>
              <div ng-if="story.file.type == 'video'">
                <video controls class="storyline-img">
                  <source src="{{story.file.url}}" type="video/mp4">
                  Your browser does not support the video tag.
                </video>
              </div>
        			<!-- TODO: VIDEO -->
        		</p>

	          <!-- comments -->
            <div ng-include="'app/memorial/comment/comment.html'"></div>
	      </div>
	  </li>
    <li class="storyline-story media text-center">
      <button class="btn btn-xs btn-default push" ng-click="fetchMoreStories()">MORE</button>
    </li>
	</ul>
</div>